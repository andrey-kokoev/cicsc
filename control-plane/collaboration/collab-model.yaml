version: cicsc/collab-model-v1
agents:
  - id: AGENT_MAIN
    kind: automation
    worktree: /home/andrey/src/cicsc
    branch_prefixes: [phase]
  - id: AGENT_KIMI
    kind: automation
    worktree: /home/andrey/src/kimi
    branch_prefixes: [phase]
  - id: AGENT_ANTIGRAVITY
    kind: automation
    worktree: /home/andrey/src/antigravity
    branch_prefixes: [phase]
claim_kinds:
  - id: CLAIM_SEMANTIC_INVARIANT
    title: Semantic invariant is constructively preserved.
    required_obligation_profile_refs: [OBLIG_KERNEL_PROOF_BRIDGE]
  - id: CLAIM_CONFORMANCE_EQUIVALENCE
    title: Backend execution matches oracle semantics on declared scope.
    required_obligation_profile_refs: [OBLIG_ORACLE_SQL_DIFFERENTIAL]
  - id: CLAIM_MIGRATION_CONTINUITY
    title: Migration preserves replay continuity and invariants.
    required_obligation_profile_refs: [OBLIG_MIGRATION_REPLAY_SAFETY]
  - id: CLAIM_EXECUTION_GOVERNANCE
    title: Execution workflow remains canonical and gate-complete.
    required_obligation_profile_refs: [OBLIG_CANONICAL_GOVERNANCE]
evidence_kinds:
  - id: EVID_THEOREM
    title: Lean theorem reference proving kernel property.
    artifact_type: theorem
  - id: EVID_DIFFERENTIAL_LOG
    title: Differential test log (oracle vs backend).
    artifact_type: test_log
  - id: EVID_GATE_REPORT
    title: Gate report artifact proving canonical checks.
    artifact_type: artifact
  - id: EVID_SCRIPT
    title: Executable checker or harness script.
    artifact_type: script
obligation_profiles:
  - id: OBLIG_KERNEL_PROOF_BRIDGE
    claim_kind_refs: [CLAIM_SEMANTIC_INVARIANT]
    required_evidence:
      - evidence_kind_ref: EVID_THEOREM
        min_count: 1
      - evidence_kind_ref: EVID_GATE_REPORT
        min_count: 1
    required_scripts:
      - scripts/check_canonical_execution_model.sh
  - id: OBLIG_ORACLE_SQL_DIFFERENTIAL
    claim_kind_refs: [CLAIM_CONFORMANCE_EQUIVALENCE]
    required_evidence:
      - evidence_kind_ref: EVID_DIFFERENTIAL_LOG
        min_count: 1
      - evidence_kind_ref: EVID_SCRIPT
        min_count: 1
    required_scripts:
      - scripts/run_cross_backend_gate.sh
      - scripts/check_conformance_gate.sh
  - id: OBLIG_MIGRATION_REPLAY_SAFETY
    claim_kind_refs: [CLAIM_MIGRATION_CONTINUITY]
    required_evidence:
      - evidence_kind_ref: EVID_DIFFERENTIAL_LOG
        min_count: 1
      - evidence_kind_ref: EVID_GATE_REPORT
        min_count: 1
    required_scripts:
      - scripts/check_phase7_required_gates.sh
      - scripts/check_phase10_migration_continuity.sh
  - id: OBLIG_CANONICAL_GOVERNANCE
    claim_kind_refs: [CLAIM_EXECUTION_GOVERNANCE]
    required_evidence:
      - evidence_kind_ref: EVID_GATE_REPORT
        min_count: 1
      - evidence_kind_ref: EVID_SCRIPT
        min_count: 1
    required_scripts:
      - scripts/check_canonical_execution_model.sh
      - scripts/check_workflow_single_source.sh
execution_bindings:
  - objective_ref: OBJ1
    capability_ref: CAP1
    claim_kind_refs: [CLAIM_SEMANTIC_INVARIANT]
    ledger_checkbox_refs: [AW1.1, AX2.1]
  - objective_ref: OBJ2
    capability_ref: CAP2
    claim_kind_refs: [CLAIM_CONFORMANCE_EQUIVALENCE, CLAIM_EXECUTION_GOVERNANCE]
    ledger_checkbox_refs: [AW1.2, AX1.1]
  - objective_ref: OBJ3
    capability_ref: CAP3
    claim_kind_refs: [CLAIM_EXECUTION_GOVERNANCE]
    ledger_checkbox_refs: [AW1.3]
  - objective_ref: OBJ4
    capability_ref: CAP4
    claim_kind_refs: [CLAIM_MIGRATION_CONTINUITY]
    ledger_checkbox_refs: [AW1.4]
  - objective_ref: OBJ5
    capability_ref: CAP5
    claim_kind_refs: [CLAIM_CONFORMANCE_EQUIVALENCE]
    ledger_checkbox_refs: [AW1.5]
handoff_protocol:
  branch_pattern: '^phase[0-9]+\.[a-z]{2}[0-9]+\.[0-9]+$'
  commit_subject_pattern: '^phase[0-9]+ [a-z]{2}[0-9]+\.[0-9]+: .+$'
  required_commit_body_tokens: ['Checkbox:', 'Invariant:', 'Proof/Test:', 'Docs:']
  required_gate_scripts:
    - scripts/check_canonical_execution_model.sh
message_transition_policy:
  initial_statuses: [queued, sent]
  terminal_statuses: [rejected, rescinded, closed]
  allowed_transitions:
    - from: queued
      to: sent
    - from: queued
      to: rescinded
    - from: sent
      to: acknowledged
    - from: sent
      to: rescinded
    - from: acknowledged
      to: fulfilled
    - from: acknowledged
      to: rejected
    - from: fulfilled
      to: ingested
    - from: ingested
      to: closed
assignments:
  - id: ASSIGN_PHASE33_AX12_KIMI
    agent_ref: AGENT_KIMI
    checkbox_ref: AX1.2
    claim_kind_ref: CLAIM_EXECUTION_GOVERNANCE
    worktree: /home/andrey/src/kimi
    branch: phase33.ax1.2
    status: done
    notes: Implement executable coupling checks and ensure canonical gate coverage.
  - id: ASSIGN_PHASE33_AX22_ANTIGRAVITY
    agent_ref: AGENT_ANTIGRAVITY
    checkbox_ref: AX2.2
    claim_kind_ref: CLAIM_SEMANTIC_INVARIANT
    worktree: /home/andrey/src/antigravity
    branch: phase33.ax2.2
    status: assigned
    notes: Implement formalization progress admissibility gate and artifact.
message_kinds:
  - id: MSGK_ASSIGNMENT_DISPATCH
    title: Assignment dispatch from canonical worktree.
    description: Canonical worktree dispatches a typed assignment package to a target worktree.
  - id: MSGK_PROGRESS_REPORT
    title: Progress report from target worktree.
    description: Target worktree reports execution progress and attached evidence.
messages:
  - id: MSG_PHASE33_AX12_DISPATCH
    kind_ref: MSGK_ASSIGNMENT_DISPATCH
    assignment_ref: ASSIGN_PHASE33_AX12_KIMI
    from_agent_ref: AGENT_MAIN
    to_agent_ref: AGENT_KIMI
    from_worktree: /home/andrey/src/cicsc
    to_worktree: /home/andrey/src/kimi
    branch: phase33.ax1.2
    initial_status: sent
    payload_refs:
      - control-plane/collaboration/collab-model.yaml
      - docs/genesis/worktree-mediated-constructive-collaboration.md
    evidence_refs: []
    evidence_bindings: []
    notes: Dispatch AX1.2 obligations and required gate contract.
  - id: MSG_PHASE33_AX22_DISPATCH
    kind_ref: MSGK_ASSIGNMENT_DISPATCH
    assignment_ref: ASSIGN_PHASE33_AX22_ANTIGRAVITY
    from_agent_ref: AGENT_MAIN
    to_agent_ref: AGENT_ANTIGRAVITY
    from_worktree: /home/andrey/src/cicsc
    to_worktree: /home/andrey/src/antigravity
    branch: phase33.ax2.2
    initial_status: sent
    payload_refs:
      - control-plane/collaboration/collab-model.yaml
      - docs/genesis/worktree-mediated-constructive-collaboration.md
    evidence_refs: []
    evidence_bindings: []
    notes: Dispatch AX2.2 obligations and formalization admissibility criteria.
message_events:
  - id: MSGEV_PHASE33_AX12_DISPATCH_SENT
    message_ref: MSG_PHASE33_AX12_DISPATCH
    from_status: null
    to_status: sent
    actor_agent_ref: AGENT_MAIN
    at_seq: 1
    commit: 78c7de4
    evidence_bindings: []
    notes: Initial dispatch event for AX1.2 assignment.
  - id: MSGEV_PHASE33_AX22_DISPATCH_SENT
    message_ref: MSG_PHASE33_AX22_DISPATCH
    from_status: null
    to_status: sent
    actor_agent_ref: AGENT_MAIN
    at_seq: 1
    commit: 78c7de4
    evidence_bindings: []
    notes: Initial dispatch event for AX2.2 assignment.
  - id: MSGEV_PHASE33_AX12_ACK
    message_ref: MSG_PHASE33_AX12_DISPATCH
    from_status: sent
    to_status: acknowledged
    actor_agent_ref: AGENT_KIMI
    at_seq: 2
    commit: ffdb218
    evidence_bindings: []
    notes: Kimi acknowledged dispatch and accepted execution.
  - id: MSGEV_PHASE33_AX12_FULFILLED
    message_ref: MSG_PHASE33_AX12_DISPATCH
    from_status: acknowledged
    to_status: fulfilled
    actor_agent_ref: AGENT_KIMI
    at_seq: 3
    commit: ffdb218
    evidence_bindings:
      - ref: scripts/check_phase33_proof_evidence_coupling.sh
        commit: ffdb218
        digest: sha256:1111111111111111111111111111111111111111111111111111111111111111
      - ref: docs/pilot/phase33-proof-evidence-coupling.json
        commit: ffdb218
        digest: sha256:2222222222222222222222222222222222222222222222222222222222222222
    notes: Kimi completed AX1.2 outputs with required artifact/script evidence.
  - id: MSGEV_PHASE33_AX12_INGESTED
    message_ref: MSG_PHASE33_AX12_DISPATCH
    from_status: fulfilled
    to_status: ingested
    actor_agent_ref: AGENT_MAIN
    at_seq: 4
    commit: 3a17615
    evidence_bindings:
      - ref: scripts/check_phase33_proof_evidence_coupling.sh
        commit: 3a17615
        digest: sha256:3333333333333333333333333333333333333333333333333333333333333333
      - ref: docs/pilot/phase33-proof-evidence-coupling.json
        commit: 3a17615
        digest: sha256:4444444444444444444444444444444444444444444444444444444444444444
    notes: Main ingested Kimi AX1.2 commit via cherry-pick.
  - id: MSGEV_PHASE33_AX12_CLOSED
    message_ref: MSG_PHASE33_AX12_DISPATCH
    from_status: ingested
    to_status: closed
    actor_agent_ref: AGENT_MAIN
    at_seq: 5
    commit: 3a17615
    evidence_bindings: []
    notes: AX1.2 message closed after ingestion and checkbox closure.
