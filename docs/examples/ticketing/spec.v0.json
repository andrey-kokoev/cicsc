{
  "version": 0,
  "entities": {
    "Ticket": {
      "id": "string",
      "states": [
        "open",
        "triage",
        "in_progress",
        "resolved",
        "closed"
      ],
      "initial": "open",
      "attributes": {
        "title": { "type": "string" },
        "reporter_id": { "type": "string" },
        "assignee_id": { "type": "string", "optional": true }
      },
      "shadows": {
        "severity_i": { "type": "int" }
      },
      "commands": {
        "create": {
          "inputs": {
            "title": { "type": "string" },
            "reporter_id": { "type": "string" }
          },
          "emit": [
            {
              "type": "ticket_created",
              "payload": {
                "title": { "var": { "input": { "field": "title" } } },
                "reporter_id": { "var": { "input": { "field": "reporter_id" } } }
              }
            }
          ]
        },
        "triage": {
          "when": { "state_is": "open" },
          "emit": [{ "type": "ticket_triaged", "payload": {} }]
        },
        "start": {
          "when": { "state_is": "triage" },
          "emit": [{ "type": "ticket_started", "payload": {} }]
        },
        "resolve": {
          "when": { "state_is": "in_progress" },
          "emit": [{ "type": "ticket_resolved", "payload": {} }]
        },
        "close": {
          "when": { "state_is": "resolved" },
          "emit": [{ "type": "ticket_closed", "payload": {} }]
        }
      },
      "reducers": {
        "ticket_created": [
          { "set_attr": { "field": "title", "value": { "var": { "e_payload": { "path": "title" } } } } },
          { "set_attr": { "field": "reporter_id", "value": { "var": { "e_payload": { "path": "reporter_id" } } } } },
          { "set_shadow": { "field": "severity_i", "value": 2 } }
        ],
        "ticket_triaged": [
          { "set_state": "triage" }
        ],
        "ticket_started": [
          { "set_state": "in_progress" }
        ],
        "ticket_resolved": [
          { "set_state": "resolved" }
        ],
        "ticket_closed": [
          { "set_state": "closed" }
        ]
      }
    }
  },
  "views": {
    "queue": {
      "kind": "lanes",
      "on": "Ticket",
      "lanes": {
        "states": ["open", "triage", "in_progress", "resolved"],
        "order_by": { "field": "updated_ts", "dir": "desc" },
        "limit": 200
      }
    }
  }
}
